<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta name="description" content="Transportation Methods for Econometrics">
    <meta name="author" content="Keith O'Hara">

    <meta name="keywords" content="Economics, PhD student, NYU, New York University, Econometrics, R, C++, Cpp, Research" />

    <link rel="shortcut icon" type="image/x-icon" href="siteicon.ico">

    <title>Keith O'Hara</title>

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/modern-business.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- Syntax Highlighter -->
    <script type="text/javascript" src="js/syntaxhighlighter.js"></script>
    <link type="text/css" rel="stylesheet" href="css/swift_theme.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    
    ga('create', 'UA-93902857-1', 'auto');
    ga('send', 'pageview');

    </script>

</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="http://www.kthohr.com" style="color:white">Keith O'Hara</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="about.html">About</a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Code <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            <li>
                                <a href="bmr.html">BMR</a>
                            </li>
                            <li>
                                <a href="trame.html">TraME</a>
                            </li>
                            <li class="divider"></li>
                            <li>
                                <a href="r-mac-source.html">Building R-devel</a>
                            </li>
                            <li class="divider"></li>
                            <li>
                                <a href="other_code.html">Other</a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="research.html">Research</a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Teaching <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            <li>
                                <a href="phd_metrics.html">Econometrics</a>
                            </li>
                            <li>
                                <a href="fin_econ.html">Financial Economics</a>
                            </li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Other <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            <li>
                                <a href="links.html">Links</a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Page Content -->
    <div class="container">

        <!-- Page Heading/Breadcrumbs -->
        <div class="row">
            <div class="col-lg-12">
                <ol class="breadcrumb">
                    <li><a href="http://www.kthohr.com">Home</a></li>
                    <li><a href="trame.html">TraME</a></li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">ARUMs <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            <li><a href="trame_docs_arums.html">ARUMs</a></li>
                            <li class="divider"></li>
                            <li><a href="trame_docs_arums_empirical.html">Empirical</a></li>
                            <li><a href="trame_docs_arums_logit.html">Logit</a></li>
                            <li><a href="trame_docs_arums_none.html">None</a></li>
                            <li class="active"><a href="trame_docs_arums_probit.html">Probit</a></li>
                            <li><a href="trame_docs_arums_rsc.html">RSC</a></li>
                            <li><a href="trame_docs_arums_rusc.html">RUSC</a></li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">MMFs <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            <li><a href="trame_docs_mmfs.html">MMFs</a></li>
                            <li class="divider"></li>
                            <li><a href="trame_docs_mmfs_etu.html">ETU</a></li>
                            <li><a href="trame_docs_mmfs_ltu.html">LTU</a></li>
                            <li><a href="trame_docs_mmfs_ntu.html">NTU</a></li>
                            <li><a href="trame_docs_mmfs_tu.html">TU</a></li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Transfers <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            <li><a href="trame_docs_transfers.html">Transfers</a></li>
                            <li class="divider"></li>
                            <li><a href="trame_docs_transfers_etu.html">ETU</a></li>
                            <li><a href="trame_docs_transfers_ltu.html">LTU</a></li>
                            <li><a href="trame_docs_transfers_ntu.html">NTU</a></li>
                            <li><a href="trame_docs_transfers_tu.html">TU</a></li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Markets <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            <li><a href="trame_docs_markets.html">Markets</a></li>
                            <li class="divider"></li>
                            <li><a href="trame_docs_dse.html">DSE</a></li>
                            <li><a href="trame_docs_mfe.html">MFE</a></li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Solvers <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            <li><a href="trame_docs_solvers.html">Solvers</a></li>
                            <li class="divider"></li>
                            <li><a href="trame_docs_solvers_arc_newton.html">Arc Newton</a></li>
                            <li><a href="trame_docs_solvers_cupids_lp.html">Cupids LP</a></li>
                            <li><a href="trame_docs_solvers_darum.html">DA RUM</a></li>
                            <li><a href="trame_docs_solvers_eap_nash.html">EAP Nash</a></li>
                            <li><a href="trame_docs_solvers_ipfp.html">IPFP</a></li>
                            <li><a href="trame_docs_solvers_jacobi.html">Jacobi</a></li>
                            <li><a href="trame_docs_solvers_max_welfare.html">Max Welfare</a></li>
                            <li><a href="trame_docs_solvers_nodal_newton.html">Nodal Newton</a></li>
                            <li><a href="trame_docs_solvers_oap_lp.html">OAP LP</a></li>
                        </ul>
                    </li>
                    <li><a href="trame_docs_models.html">Models</a></li>
                </ol>
            </div>
        </div>
        <!-- /.row -->


<h3 style="text-align: center;"><strong style="font-size: 130%;">Additive Random Utility Models (ARUMs)</strong></h3>
<hr>

<p> &nbsp </p>

<h3 style="text-align: left;"><strong style="font-size: 120%;">Probit Class</strong></h3>

<div class="row">
<div class="col-md-4">
    <div class="panel panel-default">
    <div class="panel-body">
        <a href="#CD">Class Definition</a> <br>
        <a href="#MO">Member Objects</a> <br>
        <a href="#MF">Member Functions</a> <br>
        <a href="#NTS">Notes</a> <br>
        <a href="#EX">Example</a> <br>
    </div>
    </div>
</div>
</div>

<hr>

<h3 style="text-align: left;"><strong style="font-size: 120%;">Class Definition</strong></h3>

<p>Definition:</p>
<pre class="brush: cpp;"> 
class probit
{
    public:
        // build objects
        int nbX;
        int nbY;
        int nbParams;
        int aux_nbOptions;
        
        bool outsideOption;
        
        double rho;
        
        arma::cube Covar;
        
        // member functions
        ~probit(){};
         probit(){};
        explicit probit(int nbX_inp, int nbY_inp);
        explicit probit(int nbX_inp, int nbY_inp, bool outsideOption_inp);
        explicit probit(int nbX_inp, int nbY_inp, double rho_inp, bool outsideOption_inp);

        void build(int nbX_inp, int nbY_inp);
        void build(int nbX_inp, int nbY_inp, bool outsideOption_inp);
        void build(int nbX_inp, int nbY_inp, double rho_inp, bool outsideOption_inp);

        void unifCorrelCovMatrices();
        void unifCorrelCovMatrices(double rho_inp);

        empirical simul();
        empirical simul(int* nbDraws, int* seed);
        void simul(empirical& obj_out);
        void simul(empirical& obj_out, int* nbDraws, int* seed);
    
    private:
         void build_prv(int nbX_inp, int nbY_inp, double* rho_inp, bool outsideOption_inp);
};</pre>

<hr>

<h3 style="text-align: left;" id="MO"><strong style="font-size: 120%;">Member Objects</strong></h3>

<hr>

<h3 style="text-align: left;" id="MF"><strong style="font-size: 120%;">Member Functions</strong></h3>

<hr>

<h3 style="text-align: left;" id="NTS"><strong style="font-size: 120%;">Notes</strong></h3>

<hr>

<h3 style="text-align: left;" id="EX"><strong style="font-size: 120%;">Examples</strong></h3>

<p>Example:</p>

<pre class="brush: cpp;">
arma::mat U(2,3);
    U  << 1.6 << 3.2 << 1.1 << arma::endr
       << 2.9 << 1.0 << 3.1 << arma::endr;
    
    arma::mat mu(2,3);
    mu << 1.0 << 3.0 << 1.0 << arma::endr
       << 2.0 << 1.0 << 3.0 << arma::endr;
    //
    int nbX = U.n_rows;
    int nbY = U.n_cols;
    
    arma::vec n = arma::sum(mu,1);
    
    trame::probit probits;
    probits.build(nbX,nbY,true);
    //
    // correlation matrices
    probits.rho = 0.5;
    
    probits.unifCorrelCovMatrices();
    //
    // empirical object:
    int sim_seed = 1777;
    int n_draws = 1000;

    trame::empirical emp_obj;
    
    probits.simul(emp_obj, &n_draws, &sim_seed);
    
    emp_obj.U = U;
    emp_obj.mu = mu;
    //
    // first compute optimal assignment (mu)
    double G_sim_val = emp_obj.G(n);
    
    arma::cout << "G-sim(U): \n" << G_sim_val << arma::endl;
    arma::cout << "G-sim -> mu: \n" << emp_obj.mu_sol << arma::endl;
    //
    // solution to dual problem U*
    arma::mat U_star_sim;
    double Gstar_sim_val = emp_obj.Gstar(n);
    //double Gstar_sim_val = emp_obj.Gstar(n,emp_obj.mu_sol,U_star_sim);
    
    arma::cout << "G*-sim(mu): \n" << Gstar_sim_val << arma::endl;
    arma::cout << "\\nabla G-sim*(\\nabla G-sim(U)): \n" << emp_obj.U_sol << arma::endl;
    //
    // Gbar
    arma::mat mu_bar(2,3);
    mu_bar.fill(2);
    
    arma::mat U_bar_temp, mu_bar_temp;

    double val_Gbar_sim = emp_obj.Gbar(emp_obj.U_sol, mu_bar, n, U_bar_temp, mu_bar_temp);
    
    arma::cout << "Gbar-sim val: \n" << val_Gbar_sim << arma::endl;</pre>

    <hr>

        <!-- Footer -->
        <footer>
            <div class="row">
                <div class="col-lg-12">
                    <p>Copyright &copy; Keith O'Hara 2017</p>
                </div>
            </div>
        </footer>

    </div>
    <!-- /.container -->

    <!-- jQuery -->
    <script src="js/jquery.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>

</body>

</html>
